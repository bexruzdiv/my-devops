[Unit]
Description=Docker Service for {{ docker_postgresdb_container_name }}
Requires=docker.service
After=docker.service

[Service]
Restart=always
ExecStartPre=-/usr/bin/docker stop {{ docker_postgresdb_container_name }}
ExecStartPre=-/usr/bin/docker rm {{ docker_postgresdb_container_name }}
ExecStart=/usr/bin/docker run --name {{ docker_postgresdb_container_name }} \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD={{ docker_postgresdb_root_password }} \
  -e POSTGRES_DB=postgres \
  -p {{ docker_postgresdb_port }}:5432 \
  -v {{ docker_postgresdb_data_volume }}:{{ docker_postgresdb_data_volume_in_docker }} \
{% if docker_postgresdb_socket_mounting is defined and docker_postgresdb_socket_mounting %}
  -v /var/run/postgresql:/var/run/postgresql \
{% endif %}
  {{ docker_postgresdb_docker_image }}
ExecStop=/usr/bin/docker stop {{ docker_postgresdb_container_name }}

[Install]
WantedBy=multi-user.target
